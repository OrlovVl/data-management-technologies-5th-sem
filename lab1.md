```postgresql
CREATE EXTENSION IF NOT EXISTS "uuid-ossp";

CREATE TABLE Customer (
    CustomerID SERIAL PRIMARY KEY,
    LastName VARCHAR(255) NOT NULL,
    FirstName VARCHAR(255) NOT NULL,
    Patronymic VARCHAR(255),
    rowguid UUID NOT NULL DEFAULT uuid_generate_v4(),
    ModifiedDate TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE Category (
    CategoryID SERIAL PRIMARY KEY,
    CategoryName VARCHAR(255) NOT NULL,
    rowguid UUID NOT NULL DEFAULT uuid_generate_v4(),
    ModifiedDate TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE Product (
    ProductID SERIAL PRIMARY KEY,
    ProductName VARCHAR(255) NOT NULL,
    CatalogPrice DECIMAL(10, 2) NOT NULL CHECK (CatalogPrice >= 0),
    rowguid UUID NOT NULL DEFAULT uuid_generate_v4(),
    ModifiedDate TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE ProductCategory (
    ProductCategoryID SERIAL PRIMARY KEY,
    ProductID INT NOT NULL,
    CategoryID INT NOT NULL,
    rowguid UUID NOT NULL DEFAULT uuid_generate_v4(),
    ModifiedDate TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE Sale (
    SaleID SERIAL PRIMARY KEY,
    CustomerID INT NOT NULL,
    SaleDate TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    TotalAmount DECIMAL(10, 2) NOT NULL CHECK (TotalAmount >= 0),
    rowguid UUID NOT NULL DEFAULT uuid_generate_v4(),
    ModifiedDate TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE SaleDetail (
    SaleDetailID SERIAL PRIMARY KEY,
    SaleID INT NOT NULL,
    ProductID INT NOT NULL,
    Quantity INT NOT NULL CHECK (Quantity > 0),
    UnitPrice DECIMAL(10, 2) NOT NULL CHECK (UnitPrice >= 0),
    rowguid UUID NOT NULL DEFAULT uuid_generate_v4(),
    ModifiedDate TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP
);

ALTER TABLE ProductCategory
ADD CONSTRAINT FK_ProductCategory_Product
FOREIGN KEY (ProductID) REFERENCES Product(ProductID)
ON DELETE CASCADE;

ALTER TABLE ProductCategory
ADD CONSTRAINT FK_ProductCategory_Category
FOREIGN KEY (CategoryID) REFERENCES Category(CategoryID)
ON DELETE CASCADE;

ALTER TABLE Sale
ADD CONSTRAINT FK_Sale_Customer
FOREIGN KEY (CustomerID) REFERENCES Customer(CustomerID);

ALTER TABLE SaleDetail
ADD CONSTRAINT FK_SaleDetail_Sale
FOREIGN KEY (SaleID) REFERENCES Sale(SaleID)
ON DELETE CASCADE;

ALTER TABLE SaleDetail
ADD CONSTRAINT FK_SaleDetail_Product
FOREIGN KEY (ProductID) REFERENCES Product(ProductID);

-- Ограничения для пар (ProductID, CategoryID) и (SaleID, ProductID)
-- Чтобы избежать дублирования связей
ALTER TABLE ProductCategory ADD CONSTRAINT UC_ProductCategory UNIQUE (ProductID, CategoryID);
ALTER TABLE SaleDetail ADD CONSTRAINT UC_SaleDetail UNIQUE (SaleID, ProductID);

-- Создаем функцию для триггера
CREATE OR REPLACE FUNCTION update_sale_total()
RETURNS TRIGGER AS $$
BEGIN
    UPDATE Sale
    SET TotalAmount = (
        SELECT COALESCE(SUM(Quantity * UnitPrice), 0)
        FROM SaleDetail
        WHERE SaleID = COALESCE(NEW.SaleID, OLD.SaleID)
    ),
    ModifiedDate = CURRENT_TIMESTAMP
    WHERE SaleID = COALESCE(NEW.SaleID, OLD.SaleID);
    
    RETURN COALESCE(NEW, OLD);
END;
$$ LANGUAGE plpgsql;

-- Создаем триггеры для автоматического пересчета суммы продажи
CREATE TRIGGER trg_saledetail_after_insert
AFTER INSERT ON SaleDetail
FOR EACH ROW
EXECUTE FUNCTION update_sale_total();

CREATE TRIGGER trg_saledetail_after_update
AFTER UPDATE ON SaleDetail
FOR EACH ROW
EXECUTE FUNCTION update_sale_total();

CREATE TRIGGER trg_saledetail_after_delete
AFTER DELETE ON SaleDetail
FOR EACH ROW
EXECUTE FUNCTION update_sale_total();

-- Создаем индекс для часто используемого поля даты продажи
CREATE INDEX IX_Sale_SaleDate ON Sale(SaleDate);
```

```postgresql
-- Скрипт наполнения базы данных для Филиала "Запад"
-- 1. Наполняем таблицу Покупатели (Customer)
INSERT INTO Customer (LastName, FirstName, Patronymic)
VALUES
('Иванов', 'Петр', 'Сергеевич'),
('Смирнова', 'Ольга', 'Ивановна'),
('Сидоров', 'Алексей', 'Владимирович'),
('Кузнецова', 'Елена', 'Дмитриевна'),
('Попов', 'Дмитрий', 'Николаевич'),
('Васильев', 'Михаил', 'Анатольевич'),
('Петрова', 'Анна', 'Сергеевна'),
('Соколов', 'Игорь', 'Борисович'),
('Михайлов', 'Сергей', 'Викторович'),
('Новикова', 'Мария', 'Алексеевна'),
('Федоров', 'Андрей', 'Геннадьевич'),
('Кравцова', 'Ирина', 'Олеговна'),
('Орлов', 'Павел', 'Константинович'),
('Антонова', 'Юлия', 'Витальевна'),
('Захаров', 'Никита', 'Юрьевич'),
('Борисова', 'Екатерина', 'Артемовна'),
('Киселев', 'Артем', 'Игоревич'),
('Грекова', 'Наталья', 'Петровна'),
('Тимофеев', 'Константин', 'Леонидович'),
('Семенова', 'Виктория', 'Валерьевна'),
('Никитин', 'Владислав', 'Денисович'),
('Максимова', 'Дарья', 'Андреевна'),
('Виноградов', 'Георгий', 'Романович'),
('Фролова', 'Светлана', 'Геннадьевна'),
('Дорофеев', 'Роман', 'Аркадьевич');

-- 2. Наполняем таблицу Категории (Category)
INSERT INTO Category (CategoryName)
VALUES
('Электроника'),
('Бытовая техника'),
('Мебель'),
('Одежда'),
('Обувь'),
('Аксессуары'),
('Инструменты'),
('Строительные материалы'),
('Книги'),
('Спорттовары'),
('Игрушки'),
('Красота и здоровье'),
('Автотовары'),
('Продукты питания'),
('Хозтовары'),
('Садовый инвентарь'),
('Канцтовары'),
('Ювелирные изделия'),
('Антиквариат'),
('Техника для кухни'),
('Освещение'),
('Текстиль'),
('Сантехника'),
('Напольные покрытия'),
('Двери и окна');

-- 3. Наполняем таблицу Товары (Product)
INSERT INTO Product (ProductName, CatalogPrice)
VALUES
('Смартфон XYZ', 29999.99),
('Холодильник "Морозко"', 45999.50),
('Диван угловой', 32500.00),
('Куртка зимняя', 12500.00),
('Кроссовки беговые', 7500.00),
('Сумка кожаная', 8900.00),
('Дрель электрическая', 6700.00),
('Плитка керамическая', 1850.00),
('Роман "Война и мир"', 1500.00),
('Мяч футбольный', 2500.00),
('Конструктор детский', 4500.00),
('Крем для лица', 3200.00),
('Автомобильное масло', 3900.00),
('Кофе в зернах', 1250.00),
('Вешалка напольная', 2800.00),
('Лопата штыковая', 1800.00),
('Ручка шариковая', 50.00),
('Серебряные серьги', 9800.00),
('Старинная ваза', 25000.00),
('Кофемашина', 21999.99),
('Люстра хрустальная', 15700.00),
('Полотенце махровое', 1200.00),
('Смеситель для раковины', 5400.00),
('Ламинат', 1850.00),
('Межкомнатная дверь', 11200.00);

-- 4. Наполняем таблицу связи Товары-Категории (ProductCategory)
INSERT INTO ProductCategory (ProductID, CategoryID)
VALUES
(1, 1), (1, 6),   (2, 2), (2, 20),  (3, 3),           (4, 4), (4, 6),
(5, 5), (5, 10),  (6, 6),           (7, 7), (7, 13),  (8, 8), (8, 24),
(9, 9),           (10, 10), (10, 11), (11, 11),         (12, 12),
(13, 13),         (14, 14), (14, 20), (15, 3), (15, 15), (16, 7), (16, 16),
(17, 17),         (18, 18),         (19, 19),         (20, 2), (20, 20),
(21, 3), (21, 21), (22, 4), (22, 22), (23, 8), (23, 23), (24, 8), (24, 24),
(25, 8), (25, 25), (1, 17), (2, 15), (3, 22), (4, 10), (5, 4),
(6, 4), (7, 8), (8, 23), (9, 19), (10, 5),
(11, 17), (12, 18), (13, 7), (14, 15), (15, 22),
(16, 15), (17, 9), (18, 6), (19, 3), (20, 1),
(21, 18), (22, 15), (23, 15), (24, 3), (25, 3);

-- 5. Генерируем Сделки (Sale) и Детали сделок (SaleDetail) для Запада
INSERT INTO Sale (CustomerID, SaleDate, TotalAmount) VALUES
(1, '2023-01-15 10:30:00', 0),
(2, '2023-01-16 14:22:00', 0),
(3, '2023-01-17 11:45:00', 0),
(4, '2023-01-18 16:30:00', 0),
(5, '2023-01-19 09:15:00', 0),
(6, '2023-01-20 13:40:00', 0),
(7, '2023-01-21 15:20:00', 0),
(8, '2023-01-22 12:10:00', 0),
(9, '2023-01-23 17:05:00', 0),
(10, '2023-01-24 10:50:00', 0),
(11, '2023-01-25 14:35:00', 0),
(12, '2023-01-26 11:25:00', 0),
(13, '2023-01-27 16:15:00', 0),
(14, '2023-01-28 09:45:00', 0),
(15, '2023-01-29 13:30:00', 0),
(16, '2023-01-30 15:55:00', 0),
(17, '2023-01-31 12:40:00', 0),
(18, '2023-02-01 17:25:00', 0),
(19, '2023-02-02 10:10:00', 0),
(20, '2023-02-03 14:50:00', 0),
(21, '2023-02-04 11:35:00', 0),
(22, '2023-02-05 16:20:00', 0),
(23, '2023-02-06 09:05:00', 0),
(24, '2023-02-07 13:45:00', 0),
(25, '2023-02-08 15:30:00', 0),
(1, '2023-02-09 12:15:00', 0),
(2, '2023-02-10 17:00:00', 0),
(3, '2023-02-11 10:40:00', 0),
(4, '2023-02-12 14:25:00', 0),
(5, '2023-02-13 11:10:00', 0),
(6, '2023-02-14 16:00:00', 0),
(7, '2023-02-15 09:35:00', 0),
(8, '2023-02-16 13:20:00', 0),
(9, '2023-02-17 15:05:00', 0),
(10, '2023-02-18 12:50:00', 0),
(11, '2023-02-19 17:35:00', 0),
(12, '2023-02-20 10:20:00', 0),
(13, '2023-02-21 14:05:00', 0),
(14, '2023-02-22 11:55:00', 0),
(15, '2023-02-23 16:40:00', 0),
(16, '2023-02-24 09:25:00', 0),
(17, '2023-02-25 13:10:00', 0),
(18, '2023-02-26 15:55:00', 0),
(19, '2023-02-27 12:40:00', 0),
(20, '2023-02-28 17:25:00', 0),
(21, '2023-03-01 10:10:00', 0),
(22, '2023-03-02 14:50:00', 0),
(23, '2023-03-03 11:35:00', 0),
(24, '2023-03-04 16:20:00', 0),
(25, '2023-03-05 09:05:00', 0);

-- Детали продаж
INSERT INTO SaleDetail (SaleID, ProductID, Quantity, UnitPrice) VALUES
(1, 1, 1, 29999.99),
(1, 5, 2, 7500.00),
(2, 3, 1, 32500.00),
(3, 7, 1, 6700.00),
(3, 8, 5, 1850.00),
(4, 12, 2, 3200.00),
(5, 15, 1, 2800.00),
(6, 20, 1, 21999.99),
(7, 25, 2, 11200.00),
(8, 4, 1, 12500.00),
(8, 6, 1, 8900.00),
(9, 9, 3, 1500.00),
(10, 11, 1, 4500.00),
(11, 13, 2, 3900.00),
(12, 16, 1, 1800.00),
(13, 18, 1, 9800.00),
(14, 21, 1, 15700.00),
(15, 22, 3, 1200.00),
(16, 23, 1, 5400.00),
(17, 24, 4, 1850.00),
(18, 2, 1, 45999.50),
(19, 10, 2, 2500.00),
(20, 14, 1, 1250.00),
(21, 17, 5, 50.00),
(22, 19, 1, 25000.00),
(23, 1, 1, 29999.99),
(24, 5, 1, 7500.00),
(25, 7, 2, 6700.00),
(26, 8, 10, 1850.00),
(27, 12, 1, 3200.00),
(28, 15, 2, 2800.00),
(29, 20, 1, 21999.99),
(30, 25, 1, 11200.00),
(31, 4, 1, 12500.00),
(32, 6, 2, 8900.00),
(33, 9, 5, 1500.00),
(34, 11, 1, 4500.00),
(35, 13, 3, 3900.00),
(36, 16, 1, 1800.00),
(37, 18, 2, 9800.00),
(38, 21, 1, 15700.00),
(39, 22, 2, 1200.00),
(40, 23, 1, 5400.00),
(41, 24, 3, 1850.00),
(42, 2, 1, 45999.50),
(43, 10, 3, 2500.00),
(44, 14, 2, 1250.00),
(45, 17, 10, 50.00),
(46, 19, 1, 25000.00),
(47, 1, 2, 29999.99),
(48, 5, 1, 7500.00),
(49, 7, 1, 6700.00),
(50, 8, 8, 1850.00);

-- 6. Проверяем, что данные корректно добавлены и триггер сработал
SELECT 'Customer' as Table_Name, COUNT(*) as Record_Count FROM Customer
UNION ALL
SELECT 'Category', COUNT(*) FROM Category
UNION ALL
SELECT 'Product', COUNT(*) FROM Product
UNION ALL
SELECT 'ProductCategory', COUNT(*) FROM ProductCategory
UNION ALL
SELECT 'Sale', COUNT(*) FROM Sale
UNION ALL
SELECT 'SaleDetail', COUNT(*) FROM SaleDetail;

-- Проверяем, что триггер правильно рассчитал суммы
SELECT 
    'Проверка триггера: все суммы должны быть верными' as Check_Result
WHERE NOT EXISTS (
    SELECT 1
    FROM Sale s
    WHERE s.TotalAmount <> (
        SELECT COALESCE(SUM(sd.Quantity * sd.UnitPrice), 0)
        FROM SaleDetail sd 
        WHERE sd.SaleID = s.SaleID
    )
)
LIMIT 1;
```

``` postgresql
-- Скрипт наполнения базы данных для Филиала "Восток"
-- 1. Наполняем таблицу Покупатели (Customer) с восточными именами
INSERT INTO Customer (LastName, FirstName, Patronymic)
VALUES
('Танака', 'Юки', 'Хироши'),
('Ким', 'Чен', 'Су'),
('Ван', 'Ли', 'Мин'),
('Нгуен', 'Ан', 'Тхань'),
('Абдурахманов', 'Руслан', 'Магомедович'),
('Сетиаван', 'Буди', ''),
('Алиев', 'Арман', 'Каиржанович'),
('Дин', 'Цзян', ''),
('Султанов', 'Дамир', 'Рашидович'),
('Хасанов', 'Ильдар', 'Фаритович'),
('Чжан', 'Вэй', ''),
('Тран', 'Тхи', 'Ань'),
('Рахманов', 'Алишер', 'Рашидович'),
('Фам', 'Куок', ''),
('Ли', 'Сяо', 'Лун'),
('Омаров', 'Камиль', 'Русланович'),
('Юсупов', 'Ильдар', 'Рафаэльевич'),
('Хоанг', 'Минь', ''),
('Путра', 'Ади', ''),
('Цой', 'Виктор', 'Сергеевич'),
('Ибрагимов', 'Рамиль', 'Фаритович'),
('Чен', 'Юй', ''),
('Нго', 'Тхань', ''),
('Сапарбеков', 'Азамат', 'Канатбекович'),
('Ахметов', 'Бахтияр', 'Равильевич');

-- 2. Наполняем таблицу Категории (Category)
INSERT INTO Category (CategoryName)
VALUES
('Электроника'),
('Бытовая техника'),
('Мебель'),
('Одежда'),
('Обувь'),
('Аксессуары'),
('Инструменты'),
('Строительные материалы'),
('Книги'),
('Спорттовары'),
('Игрушки'),
('Красота и здоровье'),
('Автотовары'),
('Продукты питания'),
('Хозтовары'),
('Садовый инвентарь'),
('Канцтовары'),
('Ювелирные изделия'),
('Антиквариат'),
('Техника для кухни'),
('Освещение'),
('Текстиль'),
('Сантехника'),
('Напольные покрытия'),
('Двери и окна');

-- 3. Наполняем таблицу Товары (Product)
INSERT INTO Product (ProductName, CatalogPrice)
VALUES
('Смартфон XYZ', 29999.99),
('Холодильник "Морозко"', 45999.50),
('Диван угловой', 32500.00),
('Куртка зимняя', 12500.00),
('Кроссовки беговые', 7500.00),
('Сумка кожаная', 8900.00),
('Дрель электрическая', 6700.00),
('Плитка керамическая', 1850.00),
('Роман "Война и мир"', 1500.00),
('Мяч футбольный', 2500.00),
('Конструктор детский', 4500.00),
('Крем для лица', 3200.00),
('Автомобильное масло', 3900.00),
('Кофе в зернах', 1250.00),
('Вешалка напольная', 2800.00),
('Лопата штыковая', 1800.00),
('Ручка шариковая', 50.00),
('Серебряные серьги', 9800.00),
('Старинная ваза', 25000.00),
('Кофемашина', 21999.99),
('Люстра хрустальная', 15700.00),
('Полотенце махровое', 1200.00),
('Смеситель для раковины', 5400.00),
('Ламинат', 1850.00),
('Межкомнатная дверь', 11200.00);

-- 4. Наполняем таблицу связи Товары-Категории (ProductCategory)
INSERT INTO ProductCategory (ProductID, CategoryID)
VALUES
(1, 1), (1, 6),   (2, 2), (2, 20),  (3, 3),           (4, 4), (4, 6),
(5, 5), (5, 10),  (6, 6),           (7, 7), (7, 13),  (8, 8), (8, 24),
(9, 9),           (10, 10), (10, 11), (11, 11),         (12, 12),
(13, 13),         (14, 14), (14, 20), (15, 3), (15, 15), (16, 7), (16, 16),
(17, 17),         (18, 18),         (19, 19),         (20, 2), (20, 20),
(21, 3), (21, 21), (22, 4), (22, 22), (23, 8), (23, 23), (24, 8), (24, 24),
(25, 8), (25, 25), (1, 17), (2, 15), (3, 22), (4, 10), (5, 4),
(6, 4), (7, 8), (8, 23), (9, 19), (10, 5),
(11, 17), (12, 18), (13, 7), (14, 15), (15, 22),
(16, 15), (17, 9), (18, 6), (19, 3), (20, 1),
(21, 18), (22, 15), (23, 15), (24, 3), (25, 3);

-- 5. Генерируем Сделки (Sale) и Детали сделок (SaleDetail) для Востока
INSERT INTO Sale (CustomerID, SaleDate, TotalAmount) VALUES
(1, '2023-01-15 10:30:00', 0),
(2, '2023-01-16 14:22:00', 0),
(3, '2023-01-17 11:45:00', 0),
(4, '2023-01-18 16:30:00', 0),
(5, '2023-01-19 09:15:00', 0),
(6, '2023-01-20 13:40:00', 0),
(7, '2023-01-21 15:20:00', 0),
(8, '2023-01-22 12:10:00', 0),
(9, '2023-01-23 17:05:00', 0),
(10, '2023-01-24 10:50:00', 0),
(11, '2023-01-25 14:35:00', 0),
(12, '2023-01-26 11:25:00', 0),
(13, '2023-01-27 16:15:00', 0),
(14, '2023-01-28 09:45:00', 0),
(15, '2023-01-29 13:30:00', 0),
(16, '2023-01-30 15:55:00', 0),
(17, '2023-01-31 12:40:00', 0),
(18, '2023-02-01 17:25:00', 0),
(19, '2023-02-02 10:10:00', 0),
(20, '2023-02-03 14:50:00', 0),
(21, '2023-02-04 11:35:00', 0),
(22, '2023-02-05 16:20:00', 0),
(23, '2023-02-06 09:05:00', 0),
(24, '2023-02-07 13:45:00', 0),
(25, '2023-02-08 15:30:00', 0),
(1, '2023-02-09 12:15:00', 0),
(2, '2023-02-10 17:00:00', 0),
(3, '2023-02-11 10:40:00', 0),
(4, '2023-02-12 14:25:00', 0),
(5, '2023-02-13 11:10:00', 0),
(6, '2023-02-14 16:00:00', 0),
(7, '2023-02-15 09:35:00', 0),
(8, '2023-02-16 13:20:00', 0),
(9, '2023-02-17 15:05:00', 0),
(10, '2023-02-18 12:50:00', 0),
(11, '2023-02-19 17:35:00', 0),
(12, '2023-02-20 10:20:00', 0),
(13, '2023-02-21 14:05:00', 0),
(14, '2023-02-22 11:55:00', 0),
(15, '2023-02-23 16:40:00', 0),
(16, '2023-02-24 09:25:00', 0),
(17, '2023-02-25 13:10:00', 0),
(18, '2023-02-26 15:55:00', 0),
(19, '2023-02-27 12:40:00', 0),
(20, '2023-02-28 17:25:00', 0),
(21, '2023-03-01 10:10:00', 0),
(22, '2023-03-02 14:50:00', 0),
(23, '2023-03-03 11:35:00', 0),
(24, '2023-03-04 16:20:00', 0),
(25, '2023-03-05 09:05:00', 0);

-- Детали продаж
INSERT INTO SaleDetail (SaleID, ProductID, Quantity, UnitPrice) VALUES
(1, 2, 1, 45999.50),
(1, 6, 1, 8900.00),
(2, 4, 1, 12500.00),
(3, 8, 10, 1850.00),
(4, 10, 2, 2500.00),
(5, 14, 3, 1250.00),
(6, 18, 1, 9800.00),
(7, 22, 2, 1200.00),
(8, 24, 5, 1850.00),
(9, 3, 1, 32500.00),
(10, 7, 2, 6700.00),
(11, 11, 1, 4500.00),
(12, 15, 1, 2800.00),
(13, 19, 1, 25000.00),
(14, 23, 1, 5400.00),
(15, 25, 2, 11200.00),
(16, 1, 1, 29999.99),
(17, 5, 3, 7500.00),
(18, 9, 4, 1500.00),
(19, 13, 2, 3900.00),
(20, 17, 8, 50.00),
(21, 21, 1, 15700.00),
(22, 2, 1, 45999.50),
(23, 6, 2, 8900.00),
(24, 10, 1, 2500.00),
(25, 14, 2, 1250.00),
(26, 18, 1, 9800.00),
(27, 22, 3, 1200.00),
(28, 24, 4, 1850.00),
(29, 3, 1, 32500.00),
(30, 7, 1, 6700.00),
(31, 11, 2, 4500.00),
(32, 15, 1, 2800.00),
(33, 19, 1, 25000.00),
(34, 23, 1, 5400.00),
(35, 25, 1, 11200.00),
(36, 1, 2, 29999.99),
(37, 5, 1, 7500.00),
(38, 9, 3, 1500.00),
(39, 13, 1, 3900.00),
(40, 17, 5, 50.00),
(41, 21, 1, 15700.00),
(42, 2, 1, 45999.50),
(43, 6, 1, 8900.00),
(44, 10, 2, 2500.00),
(45, 14, 1, 1250.00),
(46, 18, 2, 9800.00),
(47, 22, 1, 1200.00),
(48, 24, 3, 1850.00),
(49, 3, 1, 32500.00),
(50, 7, 2, 6700.00);

-- 6. Проверяем, что данные корректно добавлены и триггер сработал
SELECT 'Customer' as Table_Name, COUNT(*) as Record_Count FROM Customer
UNION ALL
SELECT 'Category', COUNT(*) FROM Category
UNION ALL
SELECT 'Product', COUNT(*) FROM Product
UNION ALL
SELECT 'ProductCategory', COUNT(*) FROM ProductCategory
UNION ALL
SELECT 'Sale', COUNT(*) FROM Sale
UNION ALL
SELECT 'SaleDetail', COUNT(*) FROM SaleDetail;

-- Проверяем, что триггер правильно рассчитал суммы
SELECT 
    'Проверка триггера: все суммы должны быть верными' as Check_Result
WHERE NOT EXISTS (
    SELECT 1
    FROM Sale s
    WHERE s.TotalAmount <> (
        SELECT COALESCE(SUM(sd.Quantity * sd.UnitPrice), 0)
        FROM SaleDetail sd 
        WHERE sd.SaleID = s.SaleID
    )
)
LIMIT 1;
```

East branch
West branch